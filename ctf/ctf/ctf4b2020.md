# SECCON Beginners CTF 2020

- https://github.com/SECCON/Beginners_CTF_2020

# rev

## mask

IDA または Ghidra で逆コンパイル

```c
local_98[local_e0] = local_d8[local_e0] & 0x75;
local_58[local_e0] = local_d8[local_e0] & 0xeb;

"atd4`qdedtUpetepqeUdaaeUeaqau"
"c`b bk`kj`KbababcaKbacaKiacki"
```

### Solution 1

- https://gchq.github.io/CyberChef/#recipe=OR(%7B'option':'UTF8','string':'c%60b%20bk%60kj%60KbababcaKbacaKiacki'%7D)&input=YXRkNGBxZGVkdFVwZXRlcHFlVWRhYWVVZWFxYXU

### Solution 2

```python
#!/usr/bin/env python3
a = bytes(b'atd4`qdedtUpetepqeUdaaeUeaqau')
b = bytes(b'c`b bk`kj`KbababcaKbacaKiacki')
print(bytes([x | y for x, y in zip(a, b)]).decode())
```

### Solution 3

```python
#!/usr/bin/env python3
a = b'atd4`qdedtUpetepqeUdaaeUeaqau'
b = b'c`b bk`kj`KbababcaKbacaKiacki'
answer = ''
for i in range(len(a)):
    for c in range(0x20, 0x7f):
        if c & 0x75 == a[i] and c & 0xeb == b[i]:
            answer += chr(c)
            print(answer)
            break
```

### solution 4

```python
#!/usr/bin/env python3
import angr
import claripy
proj = angr.Project('./mask', auto_load_libs=False)
max_len = 64
prefix = b'ctf4b{'
arg1 = claripy.BVS('arg1', 8*max_len)
state = proj.factory.entry_state(args=[proj.filename, arg1])
for c in arg1.chop(8):
    state.solver.add(claripy.Or(claripy.And(c >= 0x20, c <= 0x7e), c == 0))
for i, ch in enumerate(prefix):
    state.solver.add(arg1.get_byte(i) == ch)
simgr = proj.factory.simgr(state)
simgr.explore(find=lambda s: b'Correct' in s.posix.dumps(1),
              avoid=lambda s: b'Wrong' in s.posix.dumps(1))
print(simgr)
if simgr.found:
    found = simgr.found[0]
    flag = found.solver.eval(arg1, cast_to=bytes)
    print('FLAG:', flag.split(b'\x00')[0].decode())
else:
    print('No solution found')
```
